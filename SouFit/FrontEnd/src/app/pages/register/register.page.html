<ion-header>
  <ion-toolbar color="light">
    <ion-title style="font-family: Inter; font-weight: 700; font-size: 20px;">
      Crear cuenta en SouFit
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding" style="background: #ffffff;">


  <ion-img src="/assets/icon/SouFitLogo.png" style="width: 80px; height: 80px; display: block; margin: 24px auto;"></ion-img>

  <!-- Nombre -->
  <ion-item style="border-radius: 10px; border: 1px solid #E0E0E0; margin-bottom: 16px;">
    <ion-label position="floating" style="font-family: Inter; font-size: 14px; font-weight: 400; color: #555;">
      Nombre
    </ion-label>
    <ion-input [(ngModel)]="nombre"></ion-input>
  </ion-item>

  <!-- Apellido -->
  <ion-item style="border-radius: 10px; border: 1px solid #E0E0E0; margin-bottom: 16px;">
    <ion-label position="floating" style="font-family: Inter; font-size: 14px; font-weight: 400; color: #555;">
      Apellido
    </ion-label>
    <ion-input [(ngModel)]="apellido"></ion-input>
  </ion-item>

  <!-- Username -->
  <ion-item style="border-radius: 10px; border: 1px solid #E0E0E0; margin-bottom: 16px;">
    <ion-label position="floating" style="font-family: Inter; font-size: 14px; font-weight: 400; color: #555;">
      Nombre de usuario
    </ion-label>
    <ion-input [(ngModel)]="username" placeholder="@usuario_ejemplo"></ion-input>
  </ion-item>


  <ion-item style="border-radius: 10px; border: 1px solid #E0E0E0; margin-bottom: 16px;">
    <ion-label position="floating" style="font-family: Inter; font-size: 14px; font-weight: 400; color: #555;">
      Correo electrónico
    </ion-label>
    <ion-input type="email" [(ngModel)]="email"></ion-input>
  </ion-item>

    <ion-item style="border-radius: 10px; border: 1px solid #E0E0E0; margin-bottom: 16px;">
      <ion-select label="Región" label-placement="floating" [(ngModel)]="id_region" (ionChange)="onRegionChange()">
        <ion-select-option *ngFor="let region of regiones" [value]="region.id_region">
          {{ region.nombre_region }}
        </ion-select-option>
      </ion-select>
    </ion-item>

    <ion-item style="border-radius: 10px; border: 1px solid #E0E0E0; margin-bottom: 16px;">
      <ion-select label="Comuna" label-placement="floating" [(ngModel)]="id_comuna" [disabled]="!id_region">
        <ion-select-option *ngFor="let comuna of comunas" [value]="comuna.id_comuna">
          {{ comuna.nombre_comuna }}
        </ion-select-option>
      </ion-select>
  </ion-item>

  <!-- Fecha de nacimiento con input nativo -->
  <ion-item style="border-radius: 10px; border: 1px solid #E0E0E0; margin-bottom: 16px;">
    <ion-label position="floating" style="font-family: Inter; font-size: 14px; font-weight: 400; color: #555;">
      Fecha de nacimiento <span style="color: red;">*</span>
    </ion-label>
    <ion-input
      type="date"
      [(ngModel)]="fecha_nacimiento"
      [max]="fechaMaxima"
      [min]="fechaMinima"
      placeholder="Selecciona tu fecha de nacimiento"
      style="font-family: Inter; font-size: 16px; padding: 12px 0;"
    ></ion-input>
  </ion-item>

  <ion-item style="border-radius: 10px; border: 1px solid #E0E0E0; margin-bottom: 16px;">
    <ion-label position="floating" style="font-family: Inter; font-size: 14px; font-weight: 400; color: #555;">
      Contraseña
    </ion-label>
    <ion-input type="password" [(ngModel)]="password"></ion-input>
  </ion-item>

  <ion-item style="border-radius: 10px; border: 1px solid #E0E0E0; margin-bottom: 24px;">
    <ion-label position="floating" style="font-family: Inter; font-size: 14px; font-weight: 400; color: #555;">
      Confirmar contraseña
    </ion-label>
    <ion-input type="password" [(ngModel)]="confirmPassword"></ion-input>
  </ion-item>


  <ion-item lines="none" style="margin-bottom: 24px;">
    <ion-checkbox slot="start" [(ngModel)]="acceptTerms"></ion-checkbox>
    <ion-text style="font-family: Inter; font-size: 14px; color: #333;">
      Acepto los <span style="color: #3B82F6; font-weight: 600;">términos y condiciones</span>
    </ion-text>
  </ion-item>

  
  <ion-button expand="block" style="background-color: #8B0000; border-radius: 12px; height: 50px; font-family: Inter; font-size: 16px; font-weight: 600;" (click)="createAccount()">
    Crear cuenta
  </ion-button>

</ion-content>

<!-- Modal de Verificación de Email -->
<ion-modal [isOpen]="mostrarModalVerificacion" [backdropDismiss]="false">
  <ng-template>
    <ion-header>
      <ion-toolbar color="primary">
        <ion-title>Verificar Email</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="cerrarModalVerificacion()" fill="clear">
            <ion-icon name="close" slot="icon-only"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    
    <ion-content class="ion-padding">
      <div class="modal-verificacion-container">
        <!-- Icono de email -->
        <div class="icono-email">
          <ion-icon name="mail-outline" size="large"></ion-icon>
        </div>
        
        <!-- Título -->
        <h2 class="titulo-modal">Verifica tu Email</h2>
        
        <!-- Mensaje -->
        <p class="mensaje-modal">
          Hemos enviado un código de verificación a:
        </p>
        <p class="email-modal">{{ emailParaVerificar }}</p>
        <p class="instrucciones-modal">
          Por favor, ingresa el código de 6 dígitos que recibiste en tu correo electrónico.
        </p>
        
        <!-- Input de código -->
        <ion-item class="codigo-item-modal" lines="full">
          <ion-label position="stacked">Código de verificación</ion-label>
          <ion-input
            type="text"
            placeholder="000000"
            [(ngModel)]="codigoVerificacion"
            (ionInput)="filtrarSoloNumerosCodigo($event)"
            maxlength="6"
            autocomplete="off"
            inputmode="numeric"
            class="codigo-input"
          ></ion-input>
        </ion-item>
        
        <!-- Botón de verificar -->
        <ion-button
          expand="block"
          (click)="verificarCodigoModal()"
          [disabled]="codigoVerificacion.length !== 6 || verificando"
          class="btn-verificar-modal"
        >
          <ion-spinner *ngIf="verificando" name="crescent" style="margin-right: 8px;"></ion-spinner>
          {{ verificando ? 'Verificando...' : 'Verificar Código' }}
        </ion-button>
        
        <!-- Reenviar código -->
        <div class="reenviar-container-modal">
          <p class="no-recibiste-modal">¿No recibiste el código?</p>
          <ion-button
            fill="clear"
            (click)="reenviarCodigoModal()"
            [disabled]="reenviandoCodigo"
            class="btn-reenviar-modal"
          >
            <ion-icon name="refresh-outline" slot="start"></ion-icon>
            {{ reenviandoCodigo ? 'Reenviando...' : 'Reenviar Código' }}
          </ion-button>
        </div>
      </div>
    </ion-content>
  </ng-template>
</ion-modal>
