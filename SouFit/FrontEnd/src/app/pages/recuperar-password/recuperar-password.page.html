<ion-header>
  <ion-toolbar color="light">
    <ion-buttons slot="start">
      <ion-button (click)="volverALogin()">
        <ion-icon name="arrow-back-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Recuperar Contraseña</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding" style="background: #ffffff;">
  
  <div class="ion-text-center ion-padding-vertical">
    <img src="assets/icon/SouFitLogo.png" alt="Logo" style="width: 80px; height: 80px;">
  </div>

  <!-- Paso 1: Ingresar email -->
  <div *ngIf="paso === 'email'" class="paso-container">
    <h2 style="font-weight: 600; margin-bottom: 8px;">Recuperar contraseña</h2>
    <p style="color: #666; margin-bottom: 24px;">
      Ingresa tu correo electrónico y te enviaremos un código de recuperación
    </p>

    <ion-item style="border-radius: 10px; border: 1px solid #E0E0E0; margin-bottom: 16px;">
      <ion-label position="floating">Correo electrónico</ion-label>
      <ion-input type="email" [(ngModel)]="email" placeholder="tu@email.com"></ion-input>
    </ion-item>

    <ion-button 
      expand="block" 
      color="primary"
      style="margin-top: 24px;"
      [disabled]="cargando"
      (click)="solicitarCodigo()">
      <ion-spinner *ngIf="cargando" name="crescent" style="margin-right: 8px;"></ion-spinner>
      {{ cargando ? 'Enviando...' : 'Enviar código' }}
    </ion-button>

    <ion-button 
      expand="block" 
      fill="clear"
      color="medium"
      style="margin-top: 16px;"
      (click)="volverALogin()">
      Volver al inicio de sesión
    </ion-button>
  </div>

  <!-- Paso 2: Ingresar código -->
  <div *ngIf="paso === 'codigo'" class="paso-container">
    <h2 style="font-weight: 600; margin-bottom: 8px;">Verificar código</h2>
    <p style="color: #666; margin-bottom: 24px;">
      Ingresa el código de 6 dígitos que recibiste en tu correo
    </p>

    <ion-item style="border-radius: 10px; border: 1px solid #E0E0E0; margin-bottom: 16px;">
      <ion-label position="floating">Código de verificación</ion-label>
      <ion-input 
        type="text" 
        [(ngModel)]="codigo" 
        placeholder="000000"
        maxlength="6"
        (ionInput)="codigo = $event.target.value.replace(/[^0-9]/g, '')">
      </ion-input>
    </ion-item>

    <ion-button 
      expand="block" 
      color="primary"
      style="margin-top: 24px;"
      [disabled]="codigo.length !== 6"
      (click)="verificarCodigo()">
      Verificar código
    </ion-button>

    <ion-button 
      expand="block" 
      fill="clear"
      color="medium"
      style="margin-top: 16px;"
      (click)="paso = 'email'">
      Volver
    </ion-button>
  </div>

  <!-- Paso 3: Nueva contraseña -->
  <div *ngIf="paso === 'nuevaPassword'" class="paso-container">
    <h2 style="font-weight: 600; margin-bottom: 8px;">Nueva contraseña</h2>
    <p style="color: #666; margin-bottom: 24px;">
      Ingresa tu nueva contraseña
    </p>

    <ion-item style="border-radius: 10px; border: 1px solid #E0E0E0; margin-bottom: 16px;">
      <ion-label position="floating">Nueva contraseña</ion-label>
      <ion-input type="password" [(ngModel)]="nuevaPassword" placeholder="Mínimo 6 caracteres"></ion-input>
    </ion-item>

    <ion-item style="border-radius: 10px; border: 1px solid #E0E0E0; margin-bottom: 16px;">
      <ion-label position="floating">Confirmar contraseña</ion-label>
      <ion-input type="password" [(ngModel)]="confirmarPassword" placeholder="Repite la contraseña"></ion-input>
    </ion-item>

    <ion-button 
      expand="block" 
      color="primary"
      style="margin-top: 24px;"
      [disabled]="cargando || !nuevaPassword || nuevaPassword !== confirmarPassword"
      (click)="resetearPassword()">
      <ion-spinner *ngIf="cargando" name="crescent" style="margin-right: 8px;"></ion-spinner>
      {{ cargando ? 'Restableciendo...' : 'Restablecer contraseña' }}
    </ion-button>

    <ion-button 
      expand="block" 
      fill="clear"
      color="medium"
      style="margin-top: 16px;"
      (click)="paso = 'codigo'">
      Volver
    </ion-button>
  </div>

</ion-content>

